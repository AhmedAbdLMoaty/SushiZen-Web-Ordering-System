<div
  class="menu-container"
  vocab="https://schema.org/"
  typeof="Menu"
  resource="https://sushizen.com/menu"
>
  <!-- JSON-LD for Menu Items -->
  <script type="application/ld+json" *ngIf="filteredItems.length > 0">
    {
      "@context": ["https://schema.org", "https://sushizen.com/vocab/sushi"],
      "@type": "Menu",
      "name": "Sushi Zen Menu",
      "description": "Discover the artistry of Japanese cuisine",
      "url": "https://sushizen.com/menu",
      "hasMenuSection": [
        {
          "@type": "MenuSection",
          "name": "Sushi",
          "hasMenuItem": [
            *ngFor="let item of filteredItems.filter(i => i.category === 'sushi'); let isLast = last"
            {
              "@type": ["MenuItem", "SushiMenuItem"],
              "name": "{{ item.itemName }}",
              "description": "{{ item.itemDescription }}",
              "image": "{{ item.itemPicture || 'assets/images/default-sushi.jpg' }}",
              "offers": {
                "@type": "Offer",
                "price": "{{ item.itemPrice }}",
                "priceCurrency": "USD",
                "availability": "{{ item.available ? 'InStock' : 'OutOfStock' }}"
              },
              "nutrition": {
                "@type": "NutritionInformation",
                "calories": "{{ item.calories || 'N/A' }}"
              },
              "isVegetarian": {{ item.isVegetarian || false }},
              "hasJapaneseName": "{{ item.japaneseName || '' }}",
              "isRaw": {{ item.isRaw || false }}
            }{{ !isLast ? ',' : '' }}
          ]
        }
      ]
    }
  </script>

  <div class="page-header">
    <div class="header-content">
      <h1 property="name">Our Menu</h1>
      <p property="description">Discover the artistry of Japanese cuisine</p>
    </div>
  </div>

  <div class="menu-filters">
    <div class="search-bar">
      <mat-icon>search</mat-icon>
      <input
        type="text"
        placeholder="Search menu items..."
        [(ngModel)]="searchQuery"
        (input)="filterItems()"
      />
    </div>

    <div class="filter-chips">
      <div
        class="chip"
        [class.active]="activeCategory === 'all'"
        (click)="filterByCategory('all')"
      >
        All
      </div>
      <div
        class="chip"
        [class.active]="activeCategory === 'sushi'"
        (click)="filterByCategory('sushi')"
        typeof="MenuSection"
        property="hasMenuSection"
      >
        Sushi
      </div>
      <div
        class="chip"
        [class.active]="activeCategory === 'rolls'"
        (click)="filterByCategory('rolls')"
        typeof="MenuSection"
        property="hasMenuSection"
      >
        Rolls
      </div>
      <div
        class="chip"
        [class.active]="activeCategory === 'sashimi'"
        (click)="filterByCategory('sashimi')"
        typeof="MenuSection"
        property="hasMenuSection"
      >
        Sashimi
      </div>
      <div
        class="chip"
        [class.active]="activeCategory === 'bowls'"
        (click)="filterByCategory('bowls')"
        typeof="MenuSection"
        property="hasMenuSection"
      >
        Bowls
      </div>
    </div>
  </div>

  <div *ngIf="loading" class="loading-container">
    <div class="sushi-loader">
      <div class="sushi-piece"></div>
      <div class="chopstick chopstick-1"></div>
      <div class="chopstick chopstick-2"></div>
    </div>
    <p>Loading our delicious menu...</p>
  </div>

  <div *ngIf="error" class="error-message">
    <mat-icon>error_outline</mat-icon>
    <p>Sorry, we couldn't load the menu. Please try again later.</p>
    <button mat-raised-button color="primary" (click)="loadMenuItems()">
      Retry
    </button>
  </div>
  <div class="menu-grid" *ngIf="!loading && !error">
    <div
      class="menu-item-card"
      *ngFor="let item of filteredItems; let i = index"
      [ngStyle]="{ 'animation-delay': (i % 10) * 0.1 + 's' }"
      [class.unavailable]="!item.available"
      typeof="MenuItem"
      property="hasMenuItem"
    >
      <div class="item-image">
        <img
          [src]="item.itemPicture || 'assets/images/default-sushi.jpg'"
          [alt]="item.itemName"
          property="image"
        />
        <div class="item-badge" *ngIf="item.popular">Popular</div>
        <div class="item-badge unavailable" *ngIf="!item.available">
          Unavailable
        </div>
      </div>

      <div class="item-content">
        <h3 class="item-name" property="name">{{ item.itemName }}</h3>
        <p class="item-description" property="description">
          {{ item.itemDescription }}
        </p>

        <div class="item-footer">
          <span class="item-price" property="offers" typeof="Offer">
            <span property="price">{{ item.itemPrice | currency }}</span>
            <meta property="priceCurrency" content="USD" />
          </span>

          <button
            class="add-to-cart-btn"
            [disabled]="!item.available"
            (click)="addToCart(item)"
          >
            <mat-icon>add_shopping_cart</mat-icon>
            <span class="btn-text">Add</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <div
    *ngIf="filteredItems.length === 0 && !loading && !error"
    class="no-results"
  >
    <mat-icon>search_off</mat-icon>
    <h3>No items found</h3>
    <p>Try adjusting your search or filters</p>
    <button mat-button color="primary" (click)="resetFilters()">
      Reset Filters
    </button>
  </div>
</div>
